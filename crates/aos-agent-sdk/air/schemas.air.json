[
  {
    "$kind": "defschema",
    "name": "aos.agent/SessionId@1",
    "type": { "uuid": {} }
  },
  {
    "$kind": "defschema",
    "name": "aos.agent/RunId@1",
    "type": {
      "record": {
        "session_id": { "ref": "aos.agent/SessionId@1" },
        "run_seq": { "nat": {} }
      }
    }
  },
  {
    "$kind": "defschema",
    "name": "aos.agent/ToolBatchId@1",
    "type": {
      "record": {
        "run_id": { "ref": "aos.agent/RunId@1" },
        "batch_seq": { "nat": {} }
      }
    }
  },
  {
    "$kind": "defschema",
    "name": "aos.agent/ToolCallStatus@1",
    "type": {
      "variant": {
        "Pending": { "unit": {} },
        "Succeeded": { "unit": {} },
        "Failed": { "record": { "code": { "text": {} }, "detail": { "text": {} } } },
        "Ignored": { "unit": {} },
        "Cancelled": { "unit": {} }
      }
    }
  },
  {
    "$kind": "defschema",
    "name": "aos.agent/ActiveToolBatch@1",
    "type": {
      "record": {
        "tool_batch_id": { "ref": "aos.agent/ToolBatchId@1" },
        "intent_id": { "hash": {} },
        "params_hash": { "option": { "hash": {} } },
        "expected_call_ids": { "set": { "text": {} } },
        "call_status": {
          "map": {
            "key": { "text": {} },
            "value": { "ref": "aos.agent/ToolCallStatus@1" }
          }
        },
        "results_ref": { "option": { "hash": {} } }
      }
    }
  },
  {
    "$kind": "defschema",
    "name": "aos.agent/ReasoningEffort@1",
    "type": {
      "variant": {
        "Low": { "unit": {} },
        "Medium": { "unit": {} },
        "High": { "unit": {} }
      }
    }
  },
  {
    "$kind": "defschema",
    "name": "aos.agent/WorkspaceBinding@1",
    "type": {
      "record": {
        "workspace": { "text": {} },
        "version": { "option": { "nat": {} } }
      }
    }
  },
  {
    "$kind": "defschema",
    "name": "aos.agent/WorkspaceApplyMode@1",
    "type": {
      "variant": {
        "NextRun": { "unit": {} },
        "ImmediateIfIdle": { "unit": {} }
      }
    }
  },
  {
    "$kind": "defschema",
    "name": "aos.agent/WorkspaceSnapshot@1",
    "type": {
      "record": {
        "workspace": { "text": {} },
        "version": { "option": { "nat": {} } },
        "root_hash": { "option": { "hash": {} } },
        "index_ref": { "option": { "hash": {} } },
        "prompt_pack": { "option": { "text": {} } },
        "tool_catalog": { "option": { "text": {} } },
        "prompt_pack_ref": { "option": { "hash": {} } },
        "tool_catalog_ref": { "option": { "hash": {} } }
      }
    }
  },
  {
    "$kind": "defschema",
    "name": "aos.agent/WorkspaceSnapshotReady@1",
    "type": {
      "record": {
        "snapshot": { "ref": "aos.agent/WorkspaceSnapshot@1" },
        "prompt_pack_bytes": { "option": { "bytes": {} } },
        "tool_catalog_bytes": { "option": { "bytes": {} } }
      }
    }
  },
  {
    "$kind": "defschema",
    "name": "aos.agent/SessionConfig@1",
    "type": {
      "record": {
        "provider": { "text": {} },
        "model": { "text": {} },
        "reasoning_effort": { "option": { "ref": "aos.agent/ReasoningEffort@1" } },
        "max_tokens": { "option": { "nat": {} } },
        "workspace_binding": { "option": { "ref": "aos.agent/WorkspaceBinding@1" } },
        "default_prompt_pack": { "option": { "text": {} } },
        "default_prompt_refs": { "option": { "list": { "hash": {} } } },
        "default_tool_catalog": { "option": { "text": {} } },
        "default_tool_refs": { "option": { "list": { "hash": {} } } }
      }
    }
  },
  {
    "$kind": "defschema",
    "name": "aos.agent/RunConfig@1",
    "type": {
      "record": {
        "provider": { "text": {} },
        "model": { "text": {} },
        "reasoning_effort": { "option": { "ref": "aos.agent/ReasoningEffort@1" } },
        "max_tokens": { "option": { "nat": {} } },
        "workspace_binding": { "option": { "ref": "aos.agent/WorkspaceBinding@1" } },
        "prompt_pack": { "option": { "text": {} } },
        "prompt_refs": { "option": { "list": { "hash": {} } } },
        "tool_catalog": { "option": { "text": {} } },
        "tool_refs": { "option": { "list": { "hash": {} } } }
      }
    }
  },
  {
    "$kind": "defschema",
    "name": "aos.agent/SessionLifecycle@1",
    "type": {
      "variant": {
        "Idle": { "unit": {} },
        "Running": { "unit": {} },
        "WaitingInput": { "unit": {} },
        "Paused": { "unit": {} },
        "Cancelling": { "unit": {} },
        "Completed": { "unit": {} },
        "Failed": { "unit": {} },
        "Cancelled": { "unit": {} }
      }
    }
  },
  {
    "$kind": "defschema",
    "name": "aos.agent/HostCommand@1",
    "type": {
      "record": {
        "command_id": { "text": {} },
        "issued_at": { "time": {} },
        "command": {
          "variant": {
            "Steer": { "record": { "text": { "text": {} } } },
            "FollowUp": { "record": { "text": { "text": {} } } },
            "Pause": { "unit": {} },
            "Resume": { "unit": {} },
            "Cancel": { "record": { "reason": { "option": { "text": {} } } } },
            "Noop": { "unit": {} }
          }
        }
      }
    }
  },
  {
    "$kind": "defschema",
    "name": "aos.agent/LlmToolCall@1",
    "type": {
      "record": {
        "call_id": { "text": {} },
        "tool_name": { "text": {} },
        "arguments_ref": { "hash": {} },
        "provider_call_id": { "option": { "text": {} } }
      }
    }
  },
  {
    "$kind": "defschema",
    "name": "aos.agent/LlmToolCallList@1",
    "type": { "list": { "ref": "aos.agent/LlmToolCall@1" } }
  },
  {
    "$kind": "defschema",
    "name": "aos.agent/SessionIngressKind@1",
    "type": {
      "variant": {
        "RunRequested": {
          "record": {
            "input_ref": { "hash": {} },
            "run_overrides": { "option": { "ref": "aos.agent/SessionConfig@1" } }
          }
        },
        "HostCommandReceived": { "ref": "aos.agent/HostCommand@1" },
        "WorkspaceSyncRequested": {
          "record": {
            "workspace_binding": { "ref": "aos.agent/WorkspaceBinding@1" },
            "prompt_pack": { "option": { "text": {} } },
            "tool_catalog": { "option": { "text": {} } }
          }
        },
        "WorkspaceSyncUnchanged": {
          "record": {
            "workspace": { "text": {} },
            "version": { "option": { "nat": {} } }
          }
        },
        "WorkspaceSnapshotReady": { "ref": "aos.agent/WorkspaceSnapshotReady@1" },
        "WorkspaceSyncFailed": {
          "record": {
            "workspace": { "text": {} },
            "stage": { "text": {} },
            "detail": { "text": {} }
          }
        },
        "WorkspaceApplyRequested": {
          "record": {
            "mode": { "ref": "aos.agent/WorkspaceApplyMode@1" }
          }
        },
        "ToolBatchStarted": {
          "record": {
            "tool_batch_id": { "ref": "aos.agent/ToolBatchId@1" },
            "intent_id": { "hash": {} },
            "params_hash": { "option": { "hash": {} } },
            "expected_call_ids": { "list": { "text": {} } }
          }
        },
        "ToolCallSettled": {
          "record": {
            "tool_batch_id": { "ref": "aos.agent/ToolBatchId@1" },
            "call_id": { "text": {} },
            "status": { "ref": "aos.agent/ToolCallStatus@1" }
          }
        },
        "ToolBatchSettled": {
          "record": {
            "tool_batch_id": { "ref": "aos.agent/ToolBatchId@1" },
            "results_ref": { "option": { "hash": {} } }
          }
        },
        "ActiveToolBatchReplaced": { "ref": "aos.agent/ActiveToolBatch@1" },
        "RunCompleted": { "unit": {} },
        "RunFailed": {
          "record": { "code": { "text": {} }, "detail": { "text": {} } }
        },
        "RunCancelled": {
          "record": { "reason": { "option": { "text": {} } } }
        },
        "Noop": { "unit": {} }
      }
    }
  },
  {
    "$kind": "defschema",
    "name": "aos.agent/SessionIngress@1",
    "type": {
      "record": {
        "session_id": { "ref": "aos.agent/SessionId@1" },
        "observed_at_ns": { "time": {} },
        "ingress": { "ref": "aos.agent/SessionIngressKind@1" }
      }
    }
  },
  {
    "$kind": "defschema",
    "name": "aos.agent/PendingIntent@1",
    "type": {
      "record": {
        "effect_kind": { "text": {} },
        "params_hash": { "hash": {} },
        "intent_id": { "option": { "hash": {} } },
        "cap_slot": { "option": { "text": {} } },
        "emitted_at_ns": { "time": {} }
      }
    }
  },
  {
    "$kind": "defschema",
    "name": "aos.agent/SessionState@1",
    "type": {
      "record": {
        "session_id": { "ref": "aos.agent/SessionId@1" },
        "lifecycle": { "ref": "aos.agent/SessionLifecycle@1" },
        "next_run_seq": { "nat": {} },
        "next_tool_batch_seq": { "nat": {} },
        "session_config": { "ref": "aos.agent/SessionConfig@1" },
        "active_run_id": { "option": { "ref": "aos.agent/RunId@1" } },
        "active_run_config": { "option": { "ref": "aos.agent/RunConfig@1" } },
        "active_tool_batch": { "option": { "ref": "aos.agent/ActiveToolBatch@1" } },
        "pending_intents": {
          "map": {
            "key": { "hash": {} },
            "value": { "ref": "aos.agent/PendingIntent@1" }
          }
        },
        "in_flight_effects": { "nat": {} },
        "active_workspace_snapshot": { "option": { "ref": "aos.agent/WorkspaceSnapshot@1" } },
        "pending_workspace_snapshot": { "option": { "ref": "aos.agent/WorkspaceSnapshot@1" } },
        "pending_workspace_apply_mode": {
          "option": { "ref": "aos.agent/WorkspaceApplyMode@1" }
        },
        "pending_steer": { "list": { "text": {} } },
        "pending_follow_up": { "list": { "text": {} } },
        "created_at": { "time": {} },
        "updated_at": { "time": {} }
      }
    }
  },
  {
    "$kind": "defschema",
    "name": "aos.agent/SessionWorkflowEvent@1",
    "type": {
      "variant": {
        "Ingress": { "ref": "aos.agent/SessionIngress@1" },
        "Receipt": { "ref": "sys/EffectReceiptEnvelope@1" },
        "ReceiptRejected": { "ref": "sys/EffectReceiptRejected@1" },
        "StreamFrame": { "ref": "sys/EffectStreamFrame@1" },
        "Noop": { "unit": {} }
      }
    }
  }
]
