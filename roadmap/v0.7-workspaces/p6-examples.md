refactor examples to use workspaces, also refactor any remaining tests.