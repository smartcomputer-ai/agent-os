{
  "$kind": "manifest",
  "schemas": [
    { "name": "aos.agent/SessionId@1" },
    { "name": "aos.agent/RunId@1" },
    { "name": "aos.agent/TurnId@1" },
    { "name": "aos.agent/StepId@1" },
    { "name": "aos.agent/ToolBatchId@1" },
    { "name": "aos.agent/ToolCallStatus@1" },
    { "name": "aos.agent/ActiveToolBatch@1" },
    { "name": "aos.agent/RunLease@1" },
    { "name": "aos.agent/ReasoningEffort@1" },
    { "name": "aos.agent/WorkspaceBinding@1" },
    { "name": "aos.agent/WorkspaceApplyMode@1" },
    { "name": "aos.agent/WorkspaceSnapshot@1" },
    { "name": "aos.agent/WorkspaceSyncRequested@1" },
    { "name": "aos.agent/WorkspaceSyncUnchanged@1" },
    { "name": "aos.agent/WorkspaceSnapshotReady@1" },
    { "name": "aos.agent/WorkspaceSyncFailed@1" },
    { "name": "aos.agent/WorkspaceApplyRequested@1" },
    { "name": "aos.agent/SessionConfig@1" },
    { "name": "aos.agent/RunConfig@1" },
    { "name": "aos.agent/SessionLifecycle@1" },
    { "name": "aos.agent/HostCommand@1" },
    { "name": "aos.agent/LlmToolCall@1" },
    { "name": "aos.agent/LlmToolCallList@1" },
    { "name": "aos.agent/SessionEventKind@1" },
    { "name": "aos.agent/SessionState@1" },
    { "name": "aos.agent/SessionEvent@1" },
    { "name": "demiurge/ToolCallParams@1" },
    { "name": "demiurge/ToolCallRequested@1" },
    { "name": "sys/WorkspaceName@1" },
    { "name": "sys/WorkspaceHistory@1" },
    { "name": "sys/WorkspaceCommitMeta@1" },
    { "name": "sys/WorkspaceCommit@1" },
    { "name": "sys/WorkspaceResolveParams@1" },
    { "name": "sys/WorkspaceResolveReceipt@1" },
    { "name": "sys/WorkspaceReadRefParams@1" },
    { "name": "sys/WorkspaceRefEntry@1" },
    { "name": "sys/WorkspaceReadRefReceipt@1" },
    { "name": "sys/WorkspaceReadBytesParams@1" },
    { "name": "sys/WorkspaceReadBytesReceipt@1" },
    { "name": "sys/IntrospectManifestParams@1" },
    { "name": "sys/IntrospectManifestReceipt@1" }
  ],
  "modules": [
    { "name": "demiurge/Demiurge@1" },
    { "name": "sys/Workspace@1" },
    { "name": "sys/CapEnforceWorkspace@1" }
  ],
  "plans": [
    { "name": "aos.agent/core_prompt_sync_from_workspace@1" },
    { "name": "aos.agent/core_tool_catalog_sync_from_workspace@1" },
    { "name": "aos.agent/core_workspace_sync@1" },
    { "name": "demiurge/session_workspace_sync_wrapper@1" },
    { "name": "demiurge/tool_execute_from_request@1" }
  ],
  "caps": [{ "name": "sys/query@1" }, { "name": "sys/workspace@1" }],
  "policies": [{ "name": "demiurge/session_policy@1" }],
  "defaults": {
    "policy": "demiurge/session_policy@1",
    "cap_grants": [
      {
        "name": "cap_query",
        "cap": "sys/query@1",
        "params": {
          "record": {}
        }
      },
      {
        "name": "cap_workspace",
        "cap": "sys/workspace@1",
        "params": {
          "record": {
            "workspaces": {
              "list": [{ "text": "demiurge" }]
            },
            "ops": {
              "set": [{ "text": "resolve" }, { "text": "read" }]
            }
          }
        }
      }
    ]
  },
  "routing": {
    "events": [
      {
        "event": "aos.agent/SessionEvent@1",
        "workflow": "demiurge/Demiurge@1"
      },
      {
        "event": "sys/WorkspaceCommit@1",
        "workflow": "sys/Workspace@1",
        "key_field": "workspace"
      }
    ],
    "inboxes": []
  },
  "triggers": [
    {
      "event": "aos.agent/SessionEvent@1",
      "plan": "demiurge/session_workspace_sync_wrapper@1"
    },
    {
      "event": "demiurge/ToolCallRequested@1",
      "plan": "demiurge/tool_execute_from_request@1",
      "correlate_by": "call_id"
    }
  ],
  "effects": [
    { "name": "sys/workspace.resolve@1" },
    { "name": "sys/workspace.read_ref@1" },
    { "name": "sys/workspace.read_bytes@1" },
    { "name": "sys/introspect.manifest@1" }
  ],
  "air_version": "1"
}
